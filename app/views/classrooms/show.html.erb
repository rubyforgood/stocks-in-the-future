<div class="mx-auto w-full flex">
  <div class="mx-auto w-full">
    <% if notice.present? %>
      <p class="py-2 px-3 bg-green-50 mb-5 text-green-500 font-medium rounded-lg inline-block" id="notice"><%= notice %></p>
    <% end %>

    <h1 class="text-3xl font-bold mb-6">
      <%= [
            @classroom.name,
            ("Grade #{@classroom.grades_display}" if @classroom.grades_display.present?),
            @classroom.year_name
          ].compact.join(', ') %>
    </h1>

    <div class="mb-6 p-4 rounded-lg <%= @classroom.trading_enabled? ? 'bg-green-50 border border-green-200' : 'bg-yellow-50 border border-yellow-200' %>">
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-2">
          <span class="text-lg font-semibold <%= @classroom.trading_enabled? ? 'text-green-800' : 'text-yellow-800' %>">
            Trading Status:
          </span>
          <span class="<%= @classroom.trading_enabled? ? 'text-green-700' : 'text-yellow-700' %>">
            <%= @classroom.trading_enabled? ? '✓ Enabled' : '⚠ Disabled' %>
          </span>
        </div>
        <% if policy(@classroom).toggle_trading? %>
          <%= button_to toggle_trading_classroom_path(@classroom),
                        method: :patch,
                        class: "px-4 py-2 rounded-md font-medium transition-colors #{@classroom.trading_enabled? ? 'bg-yellow-600 hover:bg-yellow-700 text-white' : 'bg-green-600 hover:bg-green-700 text-white'}" do %>
            <%= @classroom.trading_enabled? ? 'Disable Trading' : 'Enable Trading' %>
          <% end %>
        <% end %>
      </div>
      <% unless @classroom.trading_enabled? %>
        <p class="text-sm text-yellow-700 mt-1">Students cannot place orders while trading is disabled.</p>
      <% end %>
    </div>
    <% if @can_manage_students %>
      <div class="flex justify-end gap-3">
        <%= link_to "Add Student", new_classroom_student_path(@classroom),
                    class: "tw-btn-primary" %>
        <% if policy(@classroom).edit? %>
          <%= link_to "Edit Class", edit_classroom_path(@classroom), class: "tw-btn-secondary !rounded-lg !py-3 !px-5 !text-base !text-black !ring-black" %>
        <% end %>
        <!-- TODO: Add bulk functionality in future PR -->
      </div>
    <% end %>
    <div class="flex gap-8">
      <div class="flex-1">
        <%= render 'classroom_students_table', students: @classroom.users %>
      </div>
      <!-- Temporary UI, remove when tabbed table is wired up: -->
      <%= render "grade_books_list", grade_books: @classroom.grade_books %>
    </div>
  </div>
</div>

<div class="mx-auto w-full flex">
  <div class="mx-auto w-full">
    <% if notice.present? %>
      <p class="py-2 px-3 bg-green-50 mb-5 text-green-500 font-medium rounded-lg inline-block" id="notice"><%= notice %></p>
    <% end %>

    <h1 class="text-3xl font-bold mb-6">
      <%= [
            @classroom.name,
            ("Grade #{@classroom.grades_display}" if @classroom.grades_display.present?),
            @classroom.school_year.year.name
          ].compact.join(', ') %>
    </h1>

    <div class="mb-6 p-4 rounded-lg <%= @classroom.trading_enabled? ? 'bg-green-50 border border-green-200' : 'bg-yellow-50 border border-yellow-200' %>">
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-2">
          <span class="text-lg font-semibold <%= @classroom.trading_enabled? ? 'text-green-800' : 'text-yellow-800' %>">
            Trading Status:
          </span>
          <span class="<%= @classroom.trading_enabled? ? 'text-green-700' : 'text-yellow-700' %>">
            <%= @classroom.trading_enabled? ? '✓ Enabled' : '⚠ Disabled' %>
          </span>
        </div>
        <% if policy(@classroom).toggle_trading? %>
          <%= button_to toggle_trading_classroom_path(@classroom),
                        method: :patch,
                        class: "px-4 py-2 rounded-md font-medium transition-colors #{@classroom.trading_enabled? ? 'bg-yellow-600 hover:bg-yellow-700 text-white' : 'bg-green-600 hover:bg-green-700 text-white'}" do %>
            <%= @classroom.trading_enabled? ? 'Disable Trading' : 'Enable Trading' %>
          <% end %>
        <% end %>
      </div>
      <% unless @classroom.trading_enabled? %>
        <p class="text-sm text-yellow-700 mt-1">Students cannot place orders while trading is disabled.</p>
      <% end %>
    </div>

    <%= render 'classroom_students_table', students: @classroom.users %>

    <% if policy(@classroom).edit? %>
      <div class="mt-8 pt-6 border-t border-gray-200">
        <div class="flex items-center justify-between">
          <h3 class="text-lg font-medium text-gray-900">Classroom Actions</h3>
          <div class="flex items-center gap-3">
            <%= render partial: "components/action_icon_button", locals: { options: { path: edit_classroom_path(@classroom), icon: "fa-pencil", title: "Edit classroom", aria_label: "Edit classroom", text_class: "text-blue-600" } } %>
          </div>
        </div>
      </div>
    <% end %>

    <!-- Temporary UI, remove when tabbed table is wired up: -->
    <%= render "grade_books_list", grade_books: @classroom.grade_books %>
  </div>
</div>

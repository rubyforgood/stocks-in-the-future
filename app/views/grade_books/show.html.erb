<div class="mt-8"
     <% unless @grade_book.completed? %>
     data-controller="autosave"
     data-autosave-interval-value="30000">
  <% end %>
  <div class="flex justify-between items-center mb-4">
    <h3 class="text-lg font-medium text-gray-900">Grade Book</h3>
    <div data-autosave-target="status" class="text-sm text-gray-500"></div>
  </div>

  <%= form_with model: [@classroom, @grade_book],
                url: classroom_grade_book_path(@classroom, @grade_book),
                method: :patch,
                data: { turbo_frame: "_top" },
                html: { data: { autosave_target: "form" } } do |f| %>

  <%= render partial: "table", locals: { grade_book: @grade_book } %>

  <br/>

  <div class="flex flex-col items-center">
    <%= f.submit "Save Grades",
                 disabled: @grade_book.completed?,
                 class: @grade_book.completed? ? "tw-btn-primary-disabled" : "tw-btn-primary",
                 data: { autosave_target: "button" }
    %>
  </div>

  <% end %>
  <% if current_user.admin? %>
  <div class="flex flex-col items-center pt-4">
    <%= button_to "Finalize Grades", finalize_classroom_grade_book_path(@classroom, @grade_book),
                  data: { "turbo-confirm": "Are you sure you want to finalize the grades and distribute earnings? This action cannot be undone." },
                  disabled: !@grade_book.finalizable?,
                  class: @grade_book.finalizable? ? "tw-btn-primary" : "tw-btn-primary-disabled" %>
  </div>
  <% end %>
</div>
